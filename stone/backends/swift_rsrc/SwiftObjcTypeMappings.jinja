///
/// Copyright (c) 2024 Dropbox, Inc. All rights reserved.
///
/// Auto-generated by Stone, do not modify.
///

import Foundation
import stone_sdk_objc
import stone_sdk_swift
import stone_sdk_swift_objc

{% for data_type in namespace.linearize_data_types() %}
{% set dbx_data_type_class_name = fmt_objc_type(data_type) %}
{% set db_data_type_class_name = fmt_class_prefix(data_type) %}
func map{{ dbx_data_type_class_name }}ToDBOptional(object: {{ dbx_data_type_class_name}}?) -> {{ db_data_type_class_name }}? {
    guard let object = object else { return nil }
    return map{{ dbx_data_type_class_name }}ToDB(object: object)
}

func map{{ dbx_data_type_class_name }}ToDB(object: {{ dbx_data_type_class_name}}) -> {{ db_data_type_class_name }} {
    {% if is_struct_type(data_type) %}
    {% if datatype_subtype_value_types(data_type)|length > 0 %}
    switch object {
    {% for type in datatype_subtype_value_types(data_type) %}
    case let object as {{ fmt_objc_type(type) }}:
        return {{ fmt_class_prefix(type) }}({{ shim_objc_init_args_to_legacy_objc(type) }})
    {% endfor %}
    default:
        return {{ db_data_type_class_name }}({{ shim_objc_init_args_to_legacy_objc(data_type) }})
    }
    {% else %}
    return {{ db_data_type_class_name }}({{ shim_objc_init_args_to_legacy_objc(data_type) }})
    {% endif %}
    {% elif is_union_type(data_type) %}
    {% for field in data_type.all_fields %}
    {% set field_var_name = fmt_var(field.name) %}
    {% set field_data_type, nullable = unwrap_nullable(field.data_type) %}
    {% set legacy_objc_field_name = fmt_bridged_legacy_objc_var(field.name, fmt_legacy_objc_type(field_data_type, no_ptr=True), True) %}
    {% set objc_type = fmt_objc_type(field_data_type) %}
    {% if not is_void_type(field.data_type) %}
    if let object = object.{{ fmt_shim_union_psuedo_cast(field.name) }} {
        let {{ field_var_name }} = {{ shim_objc_union_associated_type(field) }}
        return {{ db_data_type_class_name }}({{ legacy_objc_field_name }}: {{ field_var_name }})
    }
    {% else %}
    if object.{{ fmt_shim_union_psuedo_cast(field.name) }} != nil {
        return {{ db_data_type_class_name }}({{ legacy_objc_field_name }}: ())
    }
    {% endif %}
    {% endfor %}
    fatalError("codegen error")
    {% endif %}
}
{% endfor %}
